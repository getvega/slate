<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Cubyn API</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400' rel='stylesheet' type='text/css'>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li>beta version 0.0.1</li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Cubyn API! This API is organized around REST.</p>

<p>Ask your API credentials at <a href="api@cubyn.com">api@cubyn.com</a>, describing your needs. If you need help implementing the Cubyn API on your website, ask for help at <a href="api@cubyn.com">api@cubyn.com</a>!</p>

<p>Authentication is done via <a href="#authentication">HTTP Basic</a> using your credentials. All our endpoints speak JSON fluently.</p>

<p><em>4 simple steps</em></p>

<blockquote>
<p><img title="Data Model" alt="Data Model" src="images/model.png" /></p>
</blockquote>

<table><thead>
<tr>
<th>Step</th>
<th>Description</th>
<th>API METHOD</th>
</tr>
</thead><tbody>
<tr>
<td>STEP 1</td>
<td>Create a <a href="#manage-your-users">user</a></td>
<td><code class="prettyprint">POST /users</code></td>
</tr>
<tr>
<td>STEP 2</td>
<td>Create an <a href="#manage-your-orders">order</a></td>
<td><code class="prettyprint">POST /users/:id/orders</code></td>
</tr>
<tr>
<td>STEP 3</td>
<td>Describe and add your <a href="#manage-your-parcels">parcels</a></td>
<td><code class="prettyprint">POST /orders/:id/parcels</code></td>
</tr>
<tr>
<td>STEP 4</td>
<td>Finalize your order</td>
<td><code class="prettyprint">POST /orders/:id/pick</code></td>
</tr>
</tbody></table>

<p>Then Cubyn does the magic!</p>

          <h1 id="authentication">Authentication</h1>

<blockquote>
<p>Try this with your <code class="prettyprint">applicationId</code> and <code class="prettyprint">applicationSecret</code></p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.cubyn.com/v1 <span class="se">\</span>
    -u my-app:e336bfdbe671af94c4b9dfcb
</code></pre>

<blockquote>
<p>REQUEST</p>
</blockquote>
<pre class="highlight plaintext"><code>POST / HTTP/1.1
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json
</code></pre>

<blockquote>
<p>RESPONSE</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cubyn-api"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please visit developers.cubyn.com for further information on this API."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"auth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyApplication"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-app"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>All endpoints except <code class="prettyprint">GET /version</code> require a proper authentication. If you do not have your application credentials yet, please write your request at <a href="mailto:api@cubyn.com">api@cubyn.com</a>.
Your API credentials will consist of an <code class="prettyprint">applicationId</code> and an <code class="prettyprint">applicationSecret</code>. Beware that these credentials carry many privileges - so keep them secret!</p>

<p>Authentication is done through <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">HTTP&rsquo;s Basic Auth</a> with you application credentials.</p>

          <h1 id="manage-your-users">Manage your users</h1>

<h2 id="model">Model</h2>

<blockquote>
<p>User example</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pierre"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"lastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dupont"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"27 rue du Chemin Vert, 75011 Paris"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-03T17:30:31.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-03T17:30:31.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pierre@dupont.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"orders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&lt;Order&gt;</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Details</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">firstName</code></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">lastName</code></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">address *</code></td>
<td>string</td>
<td>address will be used to pickup the parcels</td>
</tr>
<tr>
<td><code class="prettyprint">email *</code></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">phone *</code></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">password</code></td>
<td>string</td>
<td>if you want the user to be able to log-in on cubyn.com</td>
</tr>
</tbody></table>

<p><code class="prettyprint">*</code> = required</p>

<h2 id="methods">Methods</h2>

<blockquote>
<p>Creating a user</p>
</blockquote>
<pre class="highlight plaintext"><code>POST /users HTTP/1.1
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json

{"firstName":"Pierre","lastName":"Dupont","email":"pierre@dupont.com"}
</code></pre>

<table><thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>GET</td>
<td><code class="prettyprint">/users</code></td>
<td>List all users owned by your application, list will not include <code class="prettyprint">orders</code> they&rsquo;ve made</td>
</tr>
<tr>
<td>POST</td>
<td><code class="prettyprint">/users</code></td>
<td>Create a new user belonging to your application</td>
</tr>
<tr>
<td>GET</td>
<td><code class="prettyprint">/users/:id</code></td>
<td>Read details for this user <em>Response will include <code class="prettyprint">orders</code> sub-documents</em></td>
</tr>
<tr>
<td>PUT</td>
<td><code class="prettyprint">/users/:id</code></td>
<td>Update this user</td>
</tr>
<tr>
<td>DELETE</td>
<td><code class="prettyprint">/users/:id</code></td>
<td>Delete this user</td>
</tr>
</tbody></table>

          <h1 id="manage-your-orders">Manage your orders</h1>

<h2 id="lifecycle-of-an-order">Lifecycle of an Order</h2>

<blockquote>
<p><img title="Order Lifecycle" alt="Order Lifecycle" src="images/lifecycle.png" /></p>
</blockquote>

<table><thead>
<tr>
<th>State</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">DRAFT</code></td>
<td>User has just created an order but has not submitted it yet</td>
</tr>
<tr>
<td><code class="prettyprint">CONFIRMED</code></td>
<td>User has submitted it, but Cubyn has not processed the order yet</td>
</tr>
<tr>
<td><code class="prettyprint">PICKING</code></td>
<td>Cubyn assigned a messenger to collect the parcels</td>
</tr>
<tr>
<td><code class="prettyprint">PACKING</code></td>
<td>The messenger has picked the parcels and delivered to our logisticians</td>
</tr>
<tr>
<td><code class="prettyprint">SHIPPED</code></td>
<td>The parcels have been posted through the carrier</td>
</tr>
</tbody></table>

<h2 id="model">Model</h2>

<blockquote>
<p>Order example</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PICKING"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"pickingDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"27 rue du Chemin Vert, 75011 Paris"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"day"</span><span class="p">:</span><span class="w"> </span><span class="s2">"27/09/2015"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"timeslot"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11-14"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"messengerType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2-wheeled"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-03T17:30:31.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updatedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-03T17:30:31.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;User&gt;</span><span class="p">,</span><span class="w">
  </span><span class="s2">"parcels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&lt;Parcel&gt;</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Details</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">status</code></td>
<td><code class="prettyprint">Enum&lt;string&gt;</code></td>
<td>See <a href="#lifecycle-of-an-order">Lifecycle of an Order</a> <em>read-only</em></td>
</tr>
<tr>
<td><code class="prettyprint">pickingDetails *</code></td>
<td><code class="prettyprint">mixed</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">↳ address</code></td>
<td><code class="prettyprint">string</code></td>
<td>a geocodable address <em>default: user&rsquo;s address</em></td>
</tr>
<tr>
<td><code class="prettyprint">↳ day *</code></td>
<td><code class="prettyprint">string</code></td>
<td><code class="prettyprint">day</code>/<code class="prettyprint">timeslot</code> has to be <em>in the future</em> <em>on a working day</em></td>
</tr>
<tr>
<td><code class="prettyprint">↳ timeslot *</code></td>
<td><code class="prettyprint">Enum&lt;string&gt;</code></td>
<td>A hour range to pickup the objects at the given address <em>allowed: <code class="prettyprint">08-11</code>, <code class="prettyprint">11-14</code> or <code class="prettyprint">14-17</code></em></td>
</tr>
<tr>
<td><code class="prettyprint">↳ messengerType *</code></td>
<td><code class="prettyprint">Enum&lt;string&gt;</code></td>
<td>depends on the size / volume of the objects <em>allowed: <code class="prettyprint">2-wheeled</code> or <code class="prettyprint">4-wheeled</code></em></td>
</tr>
<tr>
<td><code class="prettyprint">parcels</code></td>
<td><code class="prettyprint">Array&lt;Parcel&gt;</code></td>
<td>See <a href="#manage-your-parcels">Parcel Model</a></td>
</tr>
</tbody></table>

<p><code class="prettyprint">*</code> = required</p>

<h2 id="methods">Methods</h2>

<blockquote>
<p>Creating an order</p>
</blockquote>
<pre class="highlight plaintext"><code>POST /users/1/orders HTTP/1.1
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json

{"pickingDetails":{"day":"06/28/15",timeslot:"11-14","messengerType":"2-wheeled"}}
</code></pre>

<table><thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>GET</td>
<td><code class="prettyprint">/orders</code></td>
<td>List all orders created through your application</td>
</tr>
<tr>
<td>GET</td>
<td><code class="prettyprint">/orders/:id</code></td>
<td>Read details of this order <em>Response will include <code class="prettyprint">user</code> and <code class="prettyprint">parcels</code> sub-documents</em></td>
</tr>
<tr>
<td>PUT</td>
<td><code class="prettyprint">/orders/:id</code></td>
<td>Update this order <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
<tr>
<td>DELETE</td>
<td><code class="prettyprint">/orders/:id</code></td>
<td>Delete this order <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
<tr>
<td>GET</td>
<td><code class="prettyprint">/users/:id/orders</code></td>
<td>List all orders this user has created</td>
</tr>
<tr>
<td>POST</td>
<td><code class="prettyprint">/users/:id/orders</code></td>
<td>Create a new order on behalf of that user</td>
</tr>
<tr>
<td>POST</td>
<td><code class="prettyprint">/orders/:id/pick</code></td>
<td>Complete the editing phase - Cubyn will process the order! <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
</tbody></table>

          <h1 id="manage-your-parcels">Manage your parcels</h1>

<h2 id="model">Model</h2>

<blockquote>
<p>Parcel example</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone 7"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shippingDetails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"express"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3 place de la Republique, 69002 Lyon"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYZ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;Order&gt;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Details</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">name</code></td>
<td><code class="prettyprint">string</code></td>
<td>a simple description of what&rsquo;s inside the parcel</td>
</tr>
<tr>
<td><code class="prettyprint">shippingDetails</code></td>
<td><code class="prettyprint">mixed</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">↳ mode</code></td>
<td><code class="prettyprint">Enum&lt;string&gt;</code></td>
<td>shipping mode <em>allowed: <code class="prettyprint">eco</code> (within 48 hours) or <code class="prettyprint">express</code> (24h)</em> <em>Default: <code class="prettyprint">eco</code></em></td>
</tr>
<tr>
<td><code class="prettyprint">↳ address</code></td>
<td><code class="prettyprint">string</code></td>
<td>a geocodable address. If not defined, it will default to user&rsquo;s address</td>
</tr>
<tr>
<td><code class="prettyprint">reference</code></td>
<td><code class="prettyprint">string</code></td>
<td>a user reference he can use to track his parcels</td>
</tr>
<tr>
<td><code class="prettyprint">trackingId</code></td>
<td><code class="prettyprint">string</code></td>
<td>The tracking id delivered by the carrier <em>read-only</em></td>
</tr>
</tbody></table>

<p><code class="prettyprint">*</code> = required</p>

<h2 id="methods">Methods</h2>

<blockquote>
<p>Editing a parcel in a previously created order</p>
</blockquote>
<pre class="highlight plaintext"><code>POST /orders/1/parcels/1 HTTP/1.1
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json

{"reference":"XYZ", "name":"Oops"}
</code></pre>

<table><thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>GET</td>
<td><code class="prettyprint">/orders/:id/parcels</code></td>
<td>List all the parcels of this order</td>
</tr>
<tr>
<td>POST</td>
<td><code class="prettyprint">/orders/:id/parcels</code></td>
<td>Create a new Parcel within this order  <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
<tr>
<td>GET</td>
<td><code class="prettyprint">/orders/:id/parcels/:id</code></td>
<td>Read details of this parcel <em>Response will include <code class="prettyprint">order</code> sub-document</em></td>
</tr>
<tr>
<td>PUT</td>
<td><code class="prettyprint">/orders/:id/parcels/:id</code></td>
<td>Edit a parcel  <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
<tr>
<td>DELETE</td>
<td><code class="prettyprint">/orders/:id/parcels/:id</code></td>
<td>Delete a parcel  <em>will fail if not in the <code class="prettyprint">EDITING</code> phase</em></td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<blockquote>
<p>When <code class="prettyprint">PUT</code>ing or <code class="prettyprint">POST</code>ing - in case of a validation error, our API will describe each erroneous field. Here is an example:</p>

<p>&nbsp;</p>

<p>REQUEST</p>
</blockquote>
<pre class="highlight plaintext"><code>POST /users HTTP/1.1
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json

{"email": "incorrect@adress", "password": "areallylongpassword"}

</code></pre>

<blockquote>
<p>RESPONSE</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Validation error: Validation isEmail failed,\nValidation error: Validation len failed"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ValidationError"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Validation isEmail failed"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"password"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Validation len failed"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>Code</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td><code class="prettyprint">BadRequestError</code></td>
<td>Often missing a required parameter</td>
</tr>
<tr>
<td>400</td>
<td><code class="prettyprint">ValidationError</code></td>
<td>Some field is badly formatted or has validation errors</td>
</tr>
<tr>
<td>404</td>
<td><code class="prettyprint">EndpointNotFoundError</code></td>
<td>The requested url does not exist</td>
</tr>
<tr>
<td>404</td>
<td><code class="prettyprint">ResourceNotFoundError</code></td>
<td>The requested resource does not exist</td>
</tr>
<tr>
<td>403</td>
<td><code class="prettyprint">ForbiddenError</code></td>
<td>You cannot perform that action on the</td>
</tr>
<tr>
<td>50X</td>
<td><code class="prettyprint">ServerError</code></td>
<td>Oops - that&rsquo;s for us.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
